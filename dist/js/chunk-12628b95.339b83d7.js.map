{"version":3,"sources":["webpack:///./src/views/admin/Login.vue","webpack:///./src/views/admin/Login.vue?cf37","webpack:///./src/components/Alert.vue","webpack:///./src/components/Alert.vue?d299"],"names":["class","for","role","checkLogin","errors","type","id","name","rules","placeholder","userName","password","check","ref","disabled","showAlert","alert-msg","alertMsg","data","components","alert","methods","customAlert","msg","this","closeCustomAlert","loginBtn","$refs","classList","add","children","remove","$http","post","username","then","res","success","window","setTimeout","token","expired","now","Date","expiredDate","weekdayNames","tokenStart","getFullYear","getMonth","getDate","getDay","getHours","getMinutes","slice","tokenExpired","document","cookie","split","$router","push","catch","err","response","render","props"],"mappings":"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","file":"js/chunk-12628b95.339b83d7.js","sourcesContent":["<template>\n  <div class=\"py-8\">\n    <div class=\"container\">\n      <div class=\"row justify-content-center\">\n        <div class=\"col-4 position-relative\">\n          <div class=\"customer-modal-inner primary-customer-modal-inner\">\n            <h2 class=\"text-center mb-6\">登入管理後台</h2>\n            <Form v-slot=\"{ errors }\" @submit=\"checkLogin\">\n              <div class=\"mb-3\">\n                <label for=\"loginInputEmail\" class=\"form-label\">帳號</label>\n                <Field\n                  type=\"email\"\n                  id=\"loginInputEmail\"\n                  name=\"帳號\"\n                  class=\"form-control\"\n                  :class=\"{ 'is-invalid': errors['帳號'] }\"\n                  rules=\"required\"\n                  placeholder=\"example@gmail.com\"\n                  v-model.trim=\"userName\"\n                ></Field>\n                <ErrorMessage name=\"帳號\" class=\"invalid-feedback\"></ErrorMessage>\n              </div>\n              <div class=\"mb-3\">\n                <label for=\"loginInputPassword\" class=\"form-label\">密碼</label>\n                <Field\n                  type=\"password\"\n                  id=\"loginInputPassword\"\n                  name=\"密碼\"\n                  class=\"form-control\"\n                  :class=\"{ 'is-invalid': errors['密碼'] }\"\n                  rules=\"required\"\n                  v-model.trim=\"password\"\n                ></Field>\n                <ErrorMessage name=\"密碼\" class=\"invalid-feedback\"></ErrorMessage>\n              </div>\n              <div class=\"mb-5 form-check d-flex align-items-center\">\n                <input\n                  type=\"checkbox\"\n                  class=\"form-check-input mt-0\"\n                  id=\"loginCheck\"\n                  v-model=\"check\"\n                />\n                <label class=\"form-check-label small ms-2\" for=\"loginCheck\">\n                  我遵守\n                  <a class=\"text-secondary\">客戶條款</a>\n                </label>\n              </div>\n              <div class=\"d-grid gap-2 mx-auto text-center\">\n                <button\n                  type=\"submit\"\n                  class=\"btn btn-secondary mb-1 d-flex justify-content-center align-items-center\"\n                  ref=\"loginBtn\"\n                  :disabled=\"userName === '' || password === '' || check === false\"\n                >\n                  <div class=\"spinner-border spinner-border-sm text-light d-none\" role=\"status\">\n                    <span class=\"visually-hidden\">Loading...</span>\n                  </div>\n                  <p class=\"ms-1\">登入</p>\n                </button>\n                <a class=\"text-secondary\">忘記密碼？</a>\n                <p>\n                  還沒有帳號？\n                  <a class=\"text-secondary\">註冊</a>\n                </p>\n              </div>\n            </Form>\n          </div>\n          <div class=\"customer-modal-inner-shadow primary-customer-modal-inner-shadow\"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <!--alert-->\n  <alert v-if=\"showAlert\" :alert-msg=\"alertMsg\"></alert>\n</template>\n<script>\nimport alert from '@/components/Alert.vue';\n\nexport default {\n  data() {\n    return {\n      userName: '',\n      password: '',\n      check: false,\n      showAlert: false,\n      alertMsg: '',\n    };\n  },\n  components: {\n    alert,\n  },\n  methods: {\n    customAlert(msg) {\n      this.alertMsg = msg;\n      this.showAlert = true; // 秀出 alert\n    },\n    closeCustomAlert() {\n      this.showAlert = false;\n    },\n    checkLogin() {\n      const { loginBtn } = this.$refs;\n      loginBtn.classList.add('disabled');\n      loginBtn.children[0].classList.remove('d-none');\n      this.$http\n        .post(`${process.env.VUE_APP_API}/admin/signin`, {\n          username: this.userName,\n          password: this.password,\n        })\n        .then((res) => {\n          if (res.data.success) {\n            this.customAlert('登入成功，請稍候');\n            window.setTimeout(this.closeCustomAlert, 5000);\n            // token expired 放到 cookie，時效內不用一直登入\n            const { token, expired } = res.data;\n            // 把 token 開始及結束時間整理成好閱讀的格式\n            const now = new Date();\n            const expiredDate = new Date(expired);\n            const weekdayNames = ['日', '一', '二', '三', '四', '五', '六'];\n            const tokenStart = `${now.getFullYear()} 年 ${now.getMonth()\n              + 1} 月 ${now.getDate()} 日 星期${\n              weekdayNames[now.getDay()]\n            } ${now.getHours()}:${`00${now.getMinutes()}`.slice(-2)}`;\n            const tokenExpired = `${expiredDate.getFullYear()} 年 ${expiredDate.getMonth()\n              + 1} 月 ${expiredDate.getDate()} 日 星期${\n              weekdayNames[expiredDate.getDay()]\n            } ${expiredDate.getHours()}:${`00${expiredDate.getMinutes()}`.slice(-2)}`;\n            // token expired 、 login name 、 token 開始及結束時間放進 cookie\n            document.cookie = `hexToken=${token};expires=${new Date(expired)};path=/`;\n            document.cookie = `hexLoginName=${this.userName.split('@', 1)};expires=${new Date(\n              expired,\n            )};path=/`; // 登入名稱\n            document.cookie = `hexTokenStart=${tokenStart};expires=${new Date(expired)};path=/`; // 登入時間\n            document.cookie = `hexTokenExpired=${tokenExpired};expires=${new Date(expired)};path=/`; // 有效期限\n            loginBtn.classList.remove('disabled');\n            loginBtn.children[0].classList.add('d-none');\n            this.$router.push('/admin/product');\n            return;\n          }\n          this.customAlert('登入失敗，請確認帳密是否正確');\n          loginBtn.classList.remove('disabled');\n          loginBtn.children[0].classList.add('d-none');\n\n          window.setTimeout(this.closeCustomAlert, 5000);\n        })\n        .catch((err) => {\n          this.customAlert(err.response);\n          window.setTimeout(this.closeCustomAlert, 5000);\n          loginBtn.classList.remove('disabled');\n          loginBtn.children[0].classList.add('d-none');\n        });\n    },\n  },\n};\n</script>\n","import { render } from \"./Login.vue?vue&type=template&id=3fa2a613\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"alert alert-primary alert-dismissible fade show\" role=\"alert\">\n    {{ alertMsg }}\n  </div>\n</template>\n<script>\nexport default {\n  props: ['alertMsg'],\n};\n</script>\n","import { render } from \"./Alert.vue?vue&type=template&id=75396c34\"\nimport script from \"./Alert.vue?vue&type=script&lang=js\"\nexport * from \"./Alert.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}