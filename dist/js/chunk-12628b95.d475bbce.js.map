{"version":3,"sources":["webpack:///./src/views/admin/Login.vue","webpack:///./src/views/admin/Login.vue?cf37","webpack:///./src/components/Alert.vue","webpack:///./src/components/Alert.vue?d299"],"names":["class","src","alt","for","href","role","type","id","userName","aria-describedby","placeholder","password","check","ref","checkLogin","disabled","showAlert","alert-msg","alertMsg","data","components","alert","methods","customAlert","msg","this","closeCustomAlert","loginBtn","$refs","classList","add","children","remove","$http","post","username","then","res","success","window","setTimeout","token","expired","now","Date","expiredDate","weekdayNames","tokenStart","getFullYear","getMonth","getDate","getDay","getHours","getMinutes","slice","tokenExpired","document","cookie","split","$router","push","catch","err","response","render","props"],"mappings":"4IACOA,MAAM,Q,GACJA,MAAM,mB,GACJA,MAAM,O,EACT,yBAMM,OANDA,MAAM,SAAO,CAChB,yBAIE,OAHAC,IAAI,uBACJC,IAAI,YACJF,MAAM,oD,MAGLA,MAAM,2B,GACJA,MAAM,qD,GAEFA,MAAM,Q,EACT,yBAA0D,SAAnDG,IAAI,kBAAkBH,MAAM,cAAa,MAAE,G,GAU/CA,MAAM,Q,EACT,yBAA6D,SAAtDG,IAAI,qBAAqBH,MAAM,cAAa,MAAE,G,GAQlDA,MAAM,mB,EAET,yBAGQ,SAHDA,MAAM,yBAAyBG,IAAI,c,8BAAa,SAErD,yBAAoB,KAAjBC,KAAK,KAAI,U,MAGXJ,MAAM,oC,EAQP,yBAEM,OAFDA,MAAM,qDAAqDK,KAAK,U,CACnE,yBAA+C,QAAzCL,MAAM,mBAAkB,gB,KAEhC,yBAAsB,KAAnBA,MAAM,QAAO,MAAE,G,EAEpB,yBAAqB,KAAlBI,KAAK,KAAI,SAAK,G,EACjB,yBAGI,U,6BAHD,YAED,yBAAkB,KAAfA,KAAK,KAAI,Q,KAKpB,yBAAmF,OAA9EJ,MAAM,mEAAiE,S,kJA7DpF,yBAiEM,MAjEN,EAiEM,CAhEJ,yBA+DM,MA/DN,EA+DM,CA9DJ,yBA6DM,MA7DN,EA6DM,CA5DJ,EAOA,yBAoDM,MApDN,EAoDM,CAnDJ,yBAiDM,MAjDN,EAiDM,CAhDJ,yBA+CO,aA9CL,yBAUM,MAVN,EAUM,CATJ,E,4BACA,yBAOE,SANAM,KAAK,QACLN,MAAM,eACNO,GAAG,kB,qDACW,EAAAC,SAAQ,IACtBC,mBAAiB,YACjBC,YAAY,qB,4BAFE,EAAAF,c,SAAd,QAKJ,yBAQM,MARN,EAQM,CAPJ,E,4BACA,yBAKE,SAJAF,KAAK,WACLN,MAAM,eACNO,GAAG,qB,qDACW,EAAAI,SAAQ,K,4BAAR,EAAAA,c,SAAd,QAGJ,yBAMM,MANN,EAMM,C,4BALJ,yBAAkF,SAA3EL,KAAK,WAAWN,MAAM,mBAAmBO,GAAG,a,qDAAsB,EAAAK,MAAK,K,gCAAL,EAAAA,SACzE,IAKF,yBAkBM,MAlBN,EAkBM,CAjBJ,yBAWS,UAVPN,KAAK,SACLN,MAAM,qEACNa,IAAI,WACH,QAAK,8BAAE,EAAAC,YAAA,EAAAA,WAAA,qBACPC,SAAkB,KAAR,EAAAP,UAA2B,KAAR,EAAAG,WAAwB,IAAL,EAAAC,O,CAEjD,EAGA,G,gBAEF,EACA,QAON,UAMK,EAAAI,W,yBAAb,yBAAsD,G,MAA7BC,YAAW,EAAAC,U,2HAKvB,GACbC,KADa,WAEX,MAAO,CACLX,SAAU,GACVG,SAAU,GACVC,OAAO,EACPI,WAAW,EACXE,SAAU,KAGdE,WAAY,CACVC,MAAA,QAEFC,QAAS,CACPC,YADO,SACKC,GACVC,KAAKP,SAAWM,EAChBC,KAAKT,WAAY,GAEnBU,iBALO,WAMLD,KAAKT,WAAY,GAEnBF,WARO,WAQM,WACHa,EAAaF,KAAKG,MAAlBD,SACRA,EAASE,UAAUC,IAAI,YACvBH,EAASI,SAAS,GAAGF,UAAUG,OAAO,UACtCP,KAAKQ,MACFC,KADH,UACW,uCADX,iBACmD,CAC/CC,SAAUV,KAAKjB,SACfG,SAAUc,KAAKd,WAEhByB,MAAK,SAACC,GACL,GAAIA,EAAIlB,KAAKmB,QAAS,CACpB,EAAKf,YAAY,YACjBgB,OAAOC,WAAW,EAAKd,iBAAkB,KAEzC,MAA2BW,EAAIlB,KAAvBsB,EAAR,EAAQA,MAAOC,EAAf,EAAeA,QAETC,EAAM,IAAIC,KACVC,EAAc,IAAID,KAAKF,GACvBI,EAAe,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAC9CC,EAAS,UAAOJ,EAAIK,cAAX,cAA8BL,EAAIM,WAC7C,EADW,cACJN,EAAIO,UADA,gBAEbJ,EAAaH,EAAIQ,UAFJ,YAGXR,EAAIS,WAHO,YAGO,YAAKT,EAAIU,cAAeC,OAAO,IAC/CC,EAAW,UAAOV,EAAYG,cAAnB,cAAsCH,EAAYI,WAC/D,EADa,cACNJ,EAAYK,UADN,gBAEfJ,EAAaD,EAAYM,UAFV,YAGbN,EAAYO,WAHC,YAGa,YAAKP,EAAYQ,cAAeC,OAAO,IAWrE,OATAE,SAASC,OAAT,mBAA8BhB,EAA9B,oBAA+C,IAAIG,KAAKF,GAAxD,WACAc,SAASC,OAAT,uBAAkC,EAAKjD,SAASkD,MAAM,IAAK,GAA3D,oBAAyE,IAAId,KAC3EF,GADF,WAGAc,SAASC,OAAT,wBAAmCV,EAAnC,oBAAyD,IAAIH,KAAKF,GAAlE,WACAc,SAASC,OAAT,0BAAqCF,EAArC,oBAA6D,IAAIX,KAAKF,GAAtE,WACAf,EAASE,UAAUG,OAAO,YAC1BL,EAASI,SAAS,GAAGF,UAAUC,IAAI,eACnC,EAAK6B,QAAQC,KAAK,kBAGpB,EAAKrC,YAAY,kBACjBgB,OAAOC,WAAW,EAAKd,iBAAkB,QAE1CmC,OAAM,SAACC,GACN,EAAKvC,YAAYuC,EAAIC,gBCtI/B,EAAOC,OAASA,EAED,gB,uDCJRhE,MAAM,kDAAkDK,KAAK,S,wDAAlE,yBAEM,MAFN,EAEM,6BADD,EAAAa,UAAQ,GAIA,OACb+C,MAAO,CAAC,aCJV,EAAOD,OAASA,EAED","file":"js/chunk-12628b95.d475bbce.js","sourcesContent":["<template>\n  <div class=\"py-4\">\n    <div class=\"container-fluid\">\n      <div class=\"row\">\n        <div class=\"col-8\">\n          <img\n            src=\"img/3d-flame-146.png\"\n            alt=\"login-img\"\n            class=\"customer-modal-img primary-customer-modal-img\"\n          />\n        </div>\n        <div class=\"col-4 position-relative\">\n          <div class=\"customer-modal-inner primary-customer-modal-inner\">\n            <form>\n              <div class=\"mb-3\">\n                <label for=\"loginInputEmail\" class=\"form-label\">帳號</label>\n                <input\n                  type=\"email\"\n                  class=\"form-control\"\n                  id=\"loginInputEmail\"\n                  v-model.trim=\"userName\"\n                  aria-describedby=\"emailHelp\"\n                  placeholder=\"example@gmail.com\"\n                />\n              </div>\n              <div class=\"mb-3\">\n                <label for=\"loginInputPassword\" class=\"form-label\">密碼</label>\n                <input\n                  type=\"password\"\n                  class=\"form-control\"\n                  id=\"loginInputPassword\"\n                  v-model.trim=\"password\"\n                />\n              </div>\n              <div class=\"mb-5 form-check\">\n                <input type=\"checkbox\" class=\"form-check-input\" id=\"loginCheck\" v-model=\"check\" />\n                <label class=\"form-check-label small\" for=\"loginCheck\">\n                  我遵守\n                  <a href=\"#\">客戶條款</a>\n                </label>\n              </div>\n              <div class=\"d-grid gap-2 mx-auto text-center\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-dark mb-1 d-flex justify-content-center align-items-center\"\n                  ref=\"loginBtn\"\n                  @click=\"checkLogin\"\n                  :disabled=\"userName === '' || password === '' || check === false\"\n                >\n                  <div class=\"spinner-border spinner-border-sm text-light d-none\" role=\"status\">\n                    <span class=\"visually-hidden\">Loading...</span>\n                  </div>\n                  <p class=\"ms-1\">登入</p>\n                </button>\n                <a href=\"#\">忘記密碼？</a>\n                <p>\n                  還沒有帳號？\n                  <a href=\"#\">註冊</a>\n                </p>\n              </div>\n            </form>\n          </div>\n          <div class=\"customer-modal-inner-shadow primary-customer-modal-inner-shadow\"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <!--alert-->\n  <alert v-if=\"showAlert\" :alert-msg=\"alertMsg\"></alert>\n</template>\n<script>\nimport alert from '@/components/Alert.vue';\n\nexport default {\n  data() {\n    return {\n      userName: '',\n      password: '',\n      check: false,\n      showAlert: false,\n      alertMsg: '',\n    };\n  },\n  components: {\n    alert,\n  },\n  methods: {\n    customAlert(msg) {\n      this.alertMsg = msg;\n      this.showAlert = true; // 秀出 alert\n    },\n    closeCustomAlert() {\n      this.showAlert = false;\n    },\n    checkLogin() {\n      const { loginBtn } = this.$refs;\n      loginBtn.classList.add('disabled');\n      loginBtn.children[0].classList.remove('d-none');\n      this.$http\n        .post(`${process.env.VUE_APP_API}/admin/signin`, {\n          username: this.userName,\n          password: this.password,\n        })\n        .then((res) => {\n          if (res.data.success) {\n            this.customAlert('登入成功，請稍候');\n            window.setTimeout(this.closeCustomAlert, 5000);\n            // token expired 放到 cookie，時效內不用一直登入\n            const { token, expired } = res.data;\n            // 把 token 開始及結束時間整理成好閱讀的格式\n            const now = new Date();\n            const expiredDate = new Date(expired);\n            const weekdayNames = ['日', '一', '二', '三', '四', '五', '六'];\n            const tokenStart = `${now.getFullYear()} 年 ${now.getMonth()\n              + 1} 月 ${now.getDate()} 日 星期${\n              weekdayNames[now.getDay()]\n            } ${now.getHours()}:${`00${now.getMinutes()}`.slice(-2)}`;\n            const tokenExpired = `${expiredDate.getFullYear()} 年 ${expiredDate.getMonth()\n              + 1} 月 ${expiredDate.getDate()} 日 星期${\n              weekdayNames[expiredDate.getDay()]\n            } ${expiredDate.getHours()}:${`00${expiredDate.getMinutes()}`.slice(-2)}`;\n            // token expired 、 login name 、 token 開始及結束時間放進 cookie\n            document.cookie = `hexToken=${token};expires=${new Date(expired)};path=/`;\n            document.cookie = `hexLoginName=${this.userName.split('@', 1)};expires=${new Date(\n              expired,\n            )};path=/`; // 登入名稱\n            document.cookie = `hexTokenStart=${tokenStart};expires=${new Date(expired)};path=/`; // 登入時間\n            document.cookie = `hexTokenExpired=${tokenExpired};expires=${new Date(expired)};path=/`; // 有效期限\n            loginBtn.classList.remove('disabled');\n            loginBtn.children[0].classList.add('d-none');\n            this.$router.push('/admin/product');\n            return;\n          }\n          this.customAlert('登入失敗，請確認帳密是否正確');\n          window.setTimeout(this.closeCustomAlert, 5000);\n        })\n        .catch((err) => {\n          this.customAlert(err.response);\n        });\n    },\n  },\n};\n</script>\n","import { render } from \"./Login.vue?vue&type=template&id=3cd3de2c\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"alert alert-primary alert-dismissible fade show\" role=\"alert\">\n    {{ alertMsg }}\n  </div>\n</template>\n<script>\nexport default {\n  props: ['alertMsg'],\n};\n</script>\n","import { render } from \"./Alert.vue?vue&type=template&id=75396c34\"\nimport script from \"./Alert.vue?vue&type=script&lang=js\"\nexport * from \"./Alert.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}