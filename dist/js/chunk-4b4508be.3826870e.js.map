{"version":3,"sources":["webpack:///./src/components/backend/Alert.vue","webpack:///./src/components/backend/Alert.vue?e94c","webpack:///./src/views/frontend/Article.vue","webpack:///./src/views/frontend/Article.vue?7bd9"],"names":["class","role","alertMsg","props","render","id","randomProducts","length","article","title","author","create_at","tagCheck","item","key","autoplay","loop","centeredSlides","navigation","thumbs","thumbsSwiper","imagesUrl","src","setThumbsSwiper","slidesPerView","spaceBetween","freeMode","watchSlidesVisibility","watchSlidesProgress","content","to","imageUrl","alt","addComma","lowestPrice","btnShow","scrollToTop","showAlert","alert-msg","data","totalProducts","components","alert","methods","getArticleData","seed","this","$http","get","then","res","success","Date","toISOString","split","replace","getTotalProducts","customAlert","message","window","setTimeout","closeCustomAlert","catch","err","response","products","forEach","index","packageOptionsPrice","packageOptions","map","i","price","sort","x","y","lowestPriceUnit","unit","getRandomProducts","area","find","e","filterArr","push","arrSet","Set","maxSize","size","num","Math","floor","random","add","swiper","msg","scrollTo","computed","parts","toString","join","mounted","listener","scrollY","addEventListener","unmounted","removeEventListener","watch","handler","$router","go"],"mappings":"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","file":"js/chunk-4b4508be.3826870e.js","sourcesContent":["<template>\n  <div class=\"alert alert-primary alert-dismissible fade show\" role=\"alert\">\n    {{ alertMsg }}\n  </div>\n</template>\n<script>\nexport default {\n  props: ['alertMsg'],\n};\n</script>\n","import { render } from \"./Alert.vue?vue&type=template&id=2883ed4f\"\nimport script from \"./Alert.vue?vue&type=script&lang=js\"\nexport * from \"./Alert.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"pt-7\">\n    <div class=\"container\">\n      <div class=\"row justify-content-center pt-8\" :class=\"{ 'pb-8': randomProducts.length !== 0 }\">\n        <div class=\"col-lg-8\">\n          <div class=\"d-flex justify-content-between mb-lg-6 mb-md-4 mb-2\">\n            <div>\n              <h2 class=\"mb-2\">{{ article.title }}</h2>\n              <p class=\"text-gray-dark\">文：{{ article.author }}</p>\n            </div>\n            <p>{{ article.create_at }}</p>\n          </div>\n          <div class=\"mb-4\">\n            <span\n              v-for=\"(item, key) in article.tagCheck\"\n              :key=\"key\"\n              class=\"text-secondary\"\n              :class=\"{ 'ms-2': key !== 0 }\"\n              >#{{ item }}</span\n            >\n          </div>\n          <div class=\"mb-8\">\n            <Swiper\n              :autoplay=\"{\n                delay: 5000,\n                disableOnInteraction: false,\n              }\"\n              :loop=\"true\"\n              :centeredSlides=\"true\"\n              :navigation=\"true\"\n              :thumbs=\"{ swiper: thumbsSwiper }\"\n              class=\"gallery-top\"\n            >\n              <SwiperSlide v-for=\"item in article.imagesUrl\" :key=\"item.id\">\n                <img :src=\"item\" class=\"swiper-img\" />\n              </SwiperSlide>\n            </Swiper>\n            <Swiper\n              @swiper=\"setThumbsSwiper\"\n              :loop=\"true\"\n              :slidesPerView=\"4\"\n              :spaceBetween=\"10\"\n              :freeMode=\"true\"\n              :watchSlidesVisibility=\"true\"\n              :watchSlidesProgress=\"true\"\n              class=\"gallery-thumbs\"\n            >\n              <SwiperSlide v-for=\"item in article.imagesUrl\" :key=\"item.id\">\n                <img :src=\"item\" class=\"swiper-img\" />\n              </SwiperSlide>\n            </Swiper>\n          </div>\n          <div v-html=\"article.content\" class=\"ckeditor-content\"></div>\n        </div>\n      </div>\n    </div>\n    <div class=\"bg-light pt-6 pb-8\" id=\"moreActivitiesSection\">\n      <div class=\"container\">\n        <h3 class=\"text-primary mb-5\">更多相似活動</h3>\n        <div class=\"row\">\n          <div class=\"col-4\" v-for=\"(item, key) in randomProducts\" :key=\"key\">\n            <router-link :to=\"`/product/${item.id}`\" title=\"查看更多\" class=\"card overflow-hidden\">\n              <div class=\"card-img-outer\">\n                <img :src=\"item.imageUrl\" :alt=\"item.title\" class=\"card-img\" />\n              </div>\n              <div class=\"card-body\">\n                <h4 class=\"card-title ellipsis ellipsis-one-line\">{{ item.title }}</h4>\n                <p class=\"h3-md h5 text-end\">NT {{ addComma(item.lowestPrice) }} 起</p>\n              </div>\n            </router-link>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"to-top-btn\" @click=\"scrollToTop\" v-if=\"btnShow\">\n      <div class=\"to-top-btn-text\">\n        <p>回到</p>\n        <p>上方</p>\n      </div>\n    </div>\n    <!--alert-->\n    <alert v-if=\"showAlert\" :alert-msg=\"alertMsg\"></alert>\n  </div>\n</template>\n<script>\nimport alert from '@/components/backend/Alert.vue';\n\nexport default {\n  data() {\n    return {\n      article: [],\n      content: [],\n      totalProducts: [],\n      randomProducts: [],\n      showAlert: false,\n      alertMsg: '',\n      btnShow: true,\n      thumbsSwiper: null,\n    };\n  },\n  props: ['id'],\n  components: {\n    alert,\n  },\n  methods: {\n    getArticleData() {\n      const seed = this.id;\n      this.$http\n        .get(`${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/article/${seed}`)\n        .then((res) => {\n          if (res.data.success) {\n            this.article = res.data.article;\n            this.article.create_at = new Date(this.article.create_at * 1000)\n              .toISOString()\n              .split('T')[0]\n              .replace(/-/g, ' / ');\n            // // 如果 imagesUrl 裡有空字串，把它刪掉再顯示，避免圖片顯示錯誤\n            // this.moreInfo.productInfo.imagesUrl = this.moreInfo.productInfo.imagesUrl.filter(\n            //   (e) => e !== '',\n            // );\n            this.getTotalProducts();\n          } else {\n            this.customAlert(res.data.message);\n            window.setTimeout(this.closeCustomAlert, 5000);\n          }\n        })\n        .catch((err) => {\n          this.customAlert(err.response);\n          window.setTimeout(this.closeCustomAlert, 5000);\n        });\n    },\n    getTotalProducts() {\n      this.$http\n        .get(`${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/products/all`)\n        .then((res) => {\n          if (res.data.success) {\n            this.totalProducts = res.data.products;\n            this.totalProducts.forEach((item, index) => {\n              // 個別取出每個產品\n              let packageOptionsPrice = item.packageOptions.map((i) => i.price); // 取出該產品的所有方案中的價格\n              packageOptionsPrice = packageOptionsPrice.sort((x, y) => x - y); // 價格小排到大\n              // this.products[index].lowestPrice = packageOptionsPrice[0];\n              const [lowestPrice] = packageOptionsPrice; // 該產品最低價格為陣列第一個數\n              this.totalProducts[index].lowestPrice = lowestPrice;\n              // 找到該價格對應的單位\n              item.packageOptions.forEach((i) => {\n                if (i.price === lowestPrice) {\n                  this.totalProducts[index].lowestPriceUnit = i.unit;\n                }\n              });\n            });\n            this.getRandomProducts();\n          } else {\n            this.customAlert(res.data.message);\n            window.setTimeout(this.closeCustomAlert, 5000);\n          }\n        })\n        .catch((err) => {\n          this.customAlert(err.response);\n          window.setTimeout(this.closeCustomAlert, 5000);\n        });\n    },\n    getRandomProducts() {\n      const { tagCheck } = this.article;\n      let area;\n      if (\n        tagCheck.find(\n          (e) => e === '基隆'\n            || e === '台北'\n            || e === '新北'\n            || e === '桃園'\n            || e === '新竹'\n            || e === '苗栗',\n        )\n      ) {\n        area = '雙北';\n      } else if (\n        tagCheck.find((e) => e === '台中' || e === '彰化' || e === '南投' || e === '雲林')\n      ) {\n        area = '中彰投';\n      } else if (tagCheck.find((e) => e === '嘉義' || e === '台南')) {\n        area = '嘉南';\n      } else if (tagCheck.find((e) => e === '高雄' || e === '屏東')) {\n        area = '高屏';\n      } else if (\n        tagCheck.find((e) => e === '宜蘭' || e === '花蓮' || e === '台東' || e === '離島')\n      ) {\n        area = '花東';\n      }\n      const filterArr = [];\n      this.totalProducts.forEach((item) => {\n        item.tagCheck.forEach((i) => {\n          if (i === area) {\n            filterArr.push(item);\n          }\n        });\n      });\n      const arrSet = new Set([]);\n      const maxSize = filterArr.length < 3 ? filterArr.length : 3; // 該品項項目少於三項時，顯示該品項數量即可\n      for (let index = 0; arrSet.size < maxSize; index + 1) {\n        const { length } = filterArr;\n        const num = Math.floor(Math.random(length) * length); // 隨機取得商品\n        arrSet.add(num);\n      }\n      arrSet.forEach((i) => {\n        this.randomProducts.push(filterArr[i]); // 取得未重複的商品放進 randomProducts 陣列中\n      });\n    },\n    setThumbsSwiper(swiper) {\n      this.thumbsSwiper = swiper;\n    },\n    customAlert(msg) {\n      this.alertMsg = msg;\n      this.showAlert = true; // 秀出 alert\n    },\n    closeCustomAlert() {\n      this.showAlert = false;\n    },\n    scrollToTop() {\n      window.scrollTo(0, 0);\n    },\n  },\n  computed: {\n    addComma() {\n      return (price) => {\n        const parts = price.toString().split('.');\n        parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n        return `${parts.join(',')}`;\n      };\n    },\n  },\n  mounted() {\n    this.getArticleData();\n    this.listener = () => {\n      this.btnShow = window.scrollY > 0;\n    };\n    window.addEventListener('scroll', this.listener);\n  },\n  unmounted() {\n    window.removeEventListener('scroll', this.listener);\n  },\n  watch: {\n    '$route.params.id': {\n      handler() {\n        this.$router.go(); // 加這句不然按更多相似活動時，網址有變內容卻要手動重新整理才會變新商品\n      },\n    },\n  },\n};\n</script>\n","import { render } from \"./Article.vue?vue&type=template&id=2ee20984\"\nimport script from \"./Article.vue?vue&type=script&lang=js\"\nexport * from \"./Article.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}